(ns exs.clj
  (:require
   [clojure.test :refer :all]))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; test all solutions (...ones with 'with-test')
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(run-tests 'exs.clj)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(is (= true true))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 2
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(is (= (- 10 (* 2 3)) 4))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 3
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(is (= "HELLO WORLD" (.toUpperCase "hello world")))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 4
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(is (= (list :a :b :c)'(:a :b :c)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 5
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(is (= '(1 2 3 4) (conj '(2 3 4) 1)))
(is (= '(1 2 3 4) (conj '(3 4) 2 1)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 6
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(= [:a :b :c] (list :a :b :c) (vec '(:a :b :c)) (vector :a :b :c))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 7
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc7 [1 2 3 4])

  (is (= fc7 (conj [1 2 3] 4)))
  (is (= fc7 (conj [1 2] 3 4))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 8
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc8 #{:a :b :c :d})

(is (= fc8 (set '(:a :a :b :c :c :c :c :d :d))))
(is (= fc8 (clojure.set/union #{:a :b :c} #{:b :c :d}))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 9
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(= #{1 2 3 4} (conj #{1 4 3} 2))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 10
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc10 20)

  (is (= fc10 ((hash-map :a 10, :b 20, :c 30) :b)))
  (is (= fc10 (:b {:a 10, :b 20, :c 30}))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 11
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(= {:a 1, :b 2, :c 3} (conj {:a 1} {:b 2} [:c 3]))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 12
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc12 3)

  (is (= fc12 (first '(3 2 1))))
  (is (= fc12 (second [2 3 4])))
  (is (= fc12 (last (list 1 2 3)))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 13
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(= [20 30 40] (rest [10 20 30 40]))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 14
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc14 8)

  (is (= fc14 ((fn add-five [x] (+ x 5)) 3)))
  (is (= fc14 ((fn [x] (+ x 5)) 3)))
  (is (= fc14 (#(+ % 5) 3)))
  (is (= fc14 ((partial + 5) 3))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 15
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc15 #(* 2 %))

  (is (= (fc15 2) 4))
  (is (= (fc15 3) 6))
  (is (= (fc15 11) 22))
  (is (= (fc15 7) 14)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 16
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc16 #(str "Hello, " % "!"))

  (is (= (fc16  "Dave") "Hello, Dave!"))
  (is (= (fc16  "Jenn") "Hello, Jenn!"))
  (is (= (fc16  "Rhea") "Hello, Rhea!")))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 17
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

'(6 7 8)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 18
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

'(6 7)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 19
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc19 #(first (reverse %)))

  (is (= (fc19 [1 2 3 4 5]) 5))
  (is (= (fc19 '(5 4 3)) 3))
  (is (= (fc19 ["b" "c" "d"]) "d")))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 20
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc20 #(-> % butlast reverse first))

  (is (= (fc20 (list 1 2 3 4 5)) 4))
  (is (= (fc20 ["a" "b" "c"]) "b"))
  (is (= (fc20 [[1 2] [3 4]]) [1 2])))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 21
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc21 [s n]
    (last (take (inc n) s)))

  (is (= (fc21 '(4 5 6 7) 2) 6))
  (is (= (fc21 [:a :b :c] 0) :a))
  (is (= (fc21 [1 2 3 4] 1) 2))
  (is (= (fc21 '([1 2] [3 4] [5 6]) 2) [5 6])))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 22
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc22 [s]
    (.length (vec s)))

  (is (= (fc22 '(1 2 3 3 1)) 5))
  (is (= (fc22 "Hello World") 11))
  (is (= (fc22 [[1 2] [3 4] [5 6]]) 3))
  (is (= (fc22 '(13)) 1))
  (is (= (fc22 '(:a :b :c)) 3)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 23
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc23 [s]
    (into '() s))

  (is (= (fc23 [1 2 3 4 5]) [5 4 3 2 1]))
  (is (= (fc23 (sorted-set 5 7 2 7)) '(7 5 2)))
  (is (= (fc23 [[1 2][3 4][5 6]]) [[5 6][3 4][1 2]])))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 24
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc24 [a]
    (reduce + a))

  (is (= (fc24 [1 2 3]) 6))
  (is (= (fc24 (list 0 -2 5 5)) 8))
  (is (= (fc24 #{4 2 1}) 7))
  (is (= (fc24 '(0 0 -1)) -1))
  (is (= (fc24 '(1 10 3)) 14)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 48
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc48 6)

  (is (= fc48 (some #{2 7 6} [5 6 7 8])))
  (is (= fc48 (some #(when (even? %) %) [5 6 7 8]))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 58
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc58 [& fns]
    (fn [& args]
    (first
     (reduce (fn [res f]
               (list (apply f res)))
             args
             (reverse fns)))))

  (is (= [3 2 1] ((fc58 rest reverse) [1 2 3 4])))
  (is (= 5       ((fc58 (partial + 3) second) [1 2 3 4])))
  (is (= true    ((fc58 zero? #(mod % 8) +) 3 5 7 9)))
  (is (= "HELLO" ((fc58 #(.toUpperCase %) #(apply str %) take) 5 "hello world"))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 66
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc66 [a b]
    (if (zero? b)
      a
      (recur b (mod a b))))

  (is (= (fc66 2 4) 2))
  (is (= (fc66 10 5) 5))
  (is (= (fc66 5 7) 1))
  (is (= (fc66 1023 858) 33)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 97
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defn pascals-triangle [acc max]
  (let [row #(conj (into [1] (map (fn [c] (reduce + c)) (partition 2 1 %))) 1)]
    (if (= (count acc) max)
      acc
      (recur (conj acc (row (last acc))) max))))

(with-test
  (defn fc97 [n]
    (last (pascals-triangle [[1]] n)))

  (is (= (fc97 1) [1]))
  (is (= (map fc97 (range 1 6)))
      [[1]
       [1 1]
       [1 2 1]
       [1 3 3 1]
       [1 4 6 4 1]])
  (is (= (fc97 11)
         [1 10 45 120 210 252 210 120 45 10 1])))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 115
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (def fc115
    (fn [n]
      (if (zero? n)
        true
        (let [num (str n)
              cnt (count num)
              div (if (odd? cnt)
                    (dec (/ cnt 2))
                    (/ cnt 2))
              a   (reduce + (map #(Integer/parseInt (str %)) (take div num)))
              b   (reduce + (map #(Integer/parseInt (str %)) (take div (reverse num))))]
          (= a b)))))

  (is (= true  (fc115 11)))
  (is (= true  (fc115 121)))
  (is (= false (fc115 123)))
  (is (= true  (fc115 0)))
  (is (= false (fc115 88099)))
  (is (= true  (fc115 89098)))
  (is (= true  (fc115 89089)))
  (is (= (take 20 (filter fc115 (range)))
         [0 1 2 3 4 5 6 7 8 9 11 22 33 44 55 66 77 88 99 101])))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 146
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(with-test
  (defn fc146 [m]
    (into {}
          (apply concat
                 (for [[k v] m]
                   (map #(vector [k (first %)] (second %)) v)))))

  (is (= (fc146 '{a {p 1, q 2}
                  b {m 3, n 4}})
         '{[a p] 1, [a q] 2
           [b m] 3, [b n] 4}))
  (is (= (fc146 '{[1] {a b c d}
                  [2] {q r s t u v w x}})
         '{[[1] a] b, [[1] c] d,
           [[2] q] r, [[2] s] t,
           [[2] u] v, [[2] w] x}))
  (is (= (fc146 '{m {1 [a b c] 3 nil}})
         '{[m 1] [a b c], [m 3] nil})))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

